<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="index.css">
  <title>Bitcoin Address Generator and Verifier (sandboxed)</title>
  <meta charset="utf-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self';">
</head>
<body>
  <form id="calc">
    <span>Random Seed</span>
    <div id="random-hex">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
      <input type="number" min="0" max="255">
    </div>

    <h1>Compressed Version</h1>
    <span></span>
    <b>Private Key (WIF)</b>
    <input type="text" id="private-key-wif-compressed" readonly>
    <b>Public Address</b>
    <input type="text" id="public-address-compressed" readonly>

    <h1>Uncompressed Version</h1>
    <span></span>
    <span>Private Key (WIF)</span>
    <input type="text" id="private-key-wif" readonly>
    <span>Public Address</span>
    <input type="text" id="public-address" readonly>

    <span></span>
    <div id="tools">
      <p>
        <input type="button" id="explore" value="Browse" title="Validate the public key">
        <input type="button" id="mouse" value="Mouse" title="Add more randomness by moving your mouse for 10 seconds">
        <input type="submit" value="Calculate Keys" title="Calculate both public and private keys from the seed values">
      </p>
      <p>
        <input type="button" id="export" value="Export" title="Export private and public keys to a text file">
        <input type="button" id="import" value="Import" title="Import a WIF key and construct the random seed">
      </p>
      <p>
        <input type="button" id="networkcheck" value="Check Internet Access" title="Check for duplicated keys when running the random generator many times">
        <input type="button" id="integritycheck" value="Integrity Check" title="Check for duplicated keys when running the random generator many times">
      </p>
    </div>
  </form>

  <div id="chart-container">
    <canvas id="chart"></canvas>
  </div>

  <div id="stats">
    <div>
      <span>Min:</span> <b id="min"></b>,
      <span>Average:</span> <b id="avg"></b>,
      <span>Max:</span> <b id="max"></b>
    </div>
    <div>
      <span>Number of iterations:</span> <b id="iterations">N/A</b>,
      <span>Duplicates found:</span> <b id="duplicate">N/A</b>
    </div>
  </div>

  <hr>
  <ul>
    <li>This tool uses <code>window.crypto.getRandomValues</code> plus your browser metadata (user agent, resolution, screen size, ...) to generate a unique seed for you. To improve the randomness, use the "Mouse" button to slightly alter the generated values in random order.</li>
    <li>This page uses <code>default-src 'none'; script-src 'self';</code> CSP header to prevent any external access. With this policy, there is no way to send or receive data from the INTERNET.</li>
    <li>It is recommended to generate a few codes and validate them with another tool before generating your real key. You can use "bitaddress.org" or "Exodus" wallet to import the private key generated by this tool. If everything works fine, you must get the same public key from these external tools.</li>
    <li>To see if your browser is capable of generating a truly random seed, use the "Integrity Check" button. This button runs the random generator many times and if everything works fine, you will get an average of about 128 for all seed points.</li>
    <li>To support development use <b>1FeMpnM9jpkRAGiwuWxytmYCo65pwqZGRj</b></li>
  </ul>

  <script type="text/javascript" src="tools/base58.js"></script>
  <script type="text/javascript" src="tools/noble-ripemd160.js"></script>
  <script type="text/javascript" src="tools/noble-secp256k1.js"></script>
  <script type="text/javascript" src="tools/chart.min.js"></script>
  <script type="text/javascript" src="misc.js"></script>
  <script type="text/javascript" src="index.js"></script>
</body>
</html>
